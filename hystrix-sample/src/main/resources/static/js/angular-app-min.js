"use strict";angular.module("myApp",["Poop"]),function(t){function e(t){var e=/^\s*?[\+-]?(\d*\.?\d*?)\s*?$/.exec(t);return!!(e&&e.length>0)&&e[1]}function r(e,r){var o=!1;return t.each(e,function(t,e){o||(o=e==r)}),o}t.tinysort={id:"TinySort",version:"1.0.5",copyright:"Copyright (c) 2008-2011 Ron Valstar",uri:"http://tinysort.sjeiti.com/",defaults:{order:"asc",attr:"",place:"start",returns:!1,useVal:!1}},t.fn.extend({tinysort:function(o,n){o&&"string"!=typeof o&&(n=o,o=null);var i=t.extend({},t.tinysort.defaults,n),a={};this.each(function(e){var r=o&&""!=o?t(this).find(o):t(this),n="rand"==i.order?""+Math.random():""==i.attr?i.useVal?r.val():r.text():r.attr(i.attr),s=t(this).parent();a[s]||(a[s]={s:[],n:[]}),r.length>0?a[s].s.push({s:n,e:t(this),n:e}):a[s].n.push({e:t(this),n:e})});for(var s in a)(l=a[s]).s.sort(function(t,r){var o=t.s.toLowerCase?t.s.toLowerCase():t.s,n=r.s.toLowerCase?r.s.toLowerCase():r.s;return e(t.s)&&e(r.s)&&(o=parseFloat(t.s),n=parseFloat(r.s)),("asc"==i.order?1:-1)*(o<n?-1:o>n?1:0)});var c=[];for(var s in a){var l=a[s],d=[],u=t(this).length;switch(i.place){case"first":t.each(l.s,function(t,e){u=Math.min(u,e.n)});break;case"org":t.each(l.s,function(t,e){d.push(e.n)});break;case"end":u=l.n.length;break;default:u=0}for(var p=[0,0],h=0;h<t(this).length;h++){var y=h>=u&&h<u+l.s.length;r(d,h)&&(y=!0);var m=(y?l.s:l.n)[p[y?0:1]].e;m.parent().append(m),!y&&i.returns||c.push(m.get(0)),p[y?0:1]++}}return this.pushStack(c)}}),t.fn.TinySort=t.fn.Tinysort=t.fn.tsort=t.fn.tinysort}(jQuery),function(t,e){var r={};t.tmpl=function t(e,o){try{var n=/\W/.test(e)?new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+e.replace(/[\r\t\n]/g," ").split("<%").join("\t").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("\t").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');"):r[e]=r[e]||t(document.getElementById(e).innerHTML);return o?n(o):n}catch(t){console.log(t)}}}(window);var app=angular.module("Poop",["ui.knob"]);app.controller("knobCtrl",function(t){t.value=65,t.options={startAngle:30,endAngle:330,trackColor:"rgba(162,121,143,1)",barColor:"rgba(102,0,204,.5)",trackWidth:15,barWidth:15,subText:{enabled:!0,text:"Requests/second"},max:100,scale:{enabled:!0,type:"lines",width:3}}}),function(t){function e(t){return location.pathname.slice(0,location.pathname.lastIndexOf("/")+1)+t}function r(t){console.log(t)}function o(t){if((t+="").length<=3)return t;x=t.split("."),x1=x[0],x2=x.length>1?"."+x[1]:"";for(var e=/(\d+)(\d{3})/;e.test(x1);)x1=x1.replace(e,"$1,$2");return x1+x2}var n,i,a;jQuery.get(e("../templates/hystrixCommand/hystrixCircuit.html"),function(t){n=t}),jQuery.get(e("../templates/hystrixCommand/hystrixCircuitContainer.html"),function(t){i=t}),t.HystrixCommandMonitor=function(t,e){function s(t){c(t,"rollingCountBadRequests",0),h(t),t.escapedName=t.name.replace(/([ !"#$%&'()*+,./:;<=>?@[\]^`{|}~])/g,"\\$1"),l(t),p(t)}function c(t,e,r){void 0==t[e]&&(t[e]=r)}function l(t){d(t,"errorPercentage",!0),d(t,"latencyExecute_mean",!1),d(t,"latencyTotal_mean",!1)}function d(t,e,r){t[e]=u(t[e],t.reportingHosts,r)}function u(t,e,r){return r?g(t/e):Math.floor(t/e)}function p(t){var e=t.propertyValue_metricsRollingStatisticalWindowInMilliseconds/1e3,r=t.requestCount;r<0&&(r=0),t.ratePerSecond=g(r/e),t.ratePerSecondPerHost=g(r/e/t.reportingHosts)}function h(t){y(t,"reportingHosts"),y(t,"type"),y(t,"name"),y(t,"group"),y(t,"isCircuitBreakerOpen"),y(t,"errorPercentage"),y(t,"errorCount"),y(t,"requestCount"),y(t,"rollingCountCollapsedRequests"),y(t,"rollingCountExceptionsThrown"),y(t,"rollingCountFailure"),y(t,"rollingCountFallbackFailure"),y(t,"rollingCountFallbackRejection"),y(t,"rollingCountFallbackSuccess"),y(t,"rollingCountResponsesFromCache"),y(t,"rollingCountSemaphoreRejected"),y(t,"rollingCountShortCircuited"),y(t,"rollingCountSuccess"),y(t,"rollingCountThreadPoolRejected"),y(t,"rollingCountTimeout"),y(t,"rollingCountBadRequests"),y(t,"currentConcurrentExecutionCount"),y(t,"latencyExecute_mean"),y(t,"latencyExecute"),y(t,"latencyTotal_mean"),y(t,"latencyTotal"),y(t,"propertyValue_circuitBreakerRequestVolumeThreshold"),y(t,"propertyValue_circuitBreakerSleepWindowInMilliseconds"),y(t,"propertyValue_circuitBreakerErrorThresholdPercentage"),y(t,"propertyValue_circuitBreakerForceOpen"),y(t,"propertyValue_circuitBreakerForceClosed"),y(t,"propertyValue_executionIsolationStrategy"),y(t,"propertyValue_executionIsolationThreadTimeoutInMilliseconds"),y(t,"propertyValue_executionIsolationThreadInterruptOnTimeout"),y(t,"propertyValue_executionIsolationSemaphoreMaxConcurrentRequests"),y(t,"propertyValue_fallbackIsolationSemaphoreMaxConcurrentRequests"),y(t,"propertyValue_requestCacheEnabled"),y(t,"propertyValue_requestLogEnabled"),y(t,"propertyValue_metricsRollingStatisticalWindowInMilliseconds")}function y(t,e){if(void 0==t[e])throw new Error("Key Missing: "+e+" for "+t.name)}function m(e){try{s(e)}catch(t){return void r("Failed preProcessData: "+t.message)}e.addCommas=o,e.roundNumber=g,e.getInstanceAverage=u;var a=!1;if(!$("#CIRCUIT_"+e.escapedName).length){void 0!=B.args.includeDetailIcon&&B.args.includeDetailIcon?e.includeDetailIcon=!0:e.includeDetailIcon=!1;var c=tmpl(i,e);$("#"+t+" span.loading").remove(),$("#"+t).append(c),d3.selectAll("#graph_CIRCUIT_"+e.escapedName+" svg").append("svg:path"),a=!0}$("#CIRCUIT_"+e.escapedName+" div.monitor_data").html(tmpl(n,e));var l=e.ratePerSecond,d=e.ratePerSecondPerHost,p=1e8*e.errorPercentage+l;$("#CIRCUIT_"+e.escapedName).attr("rate_value",l),$("#CIRCUIT_"+e.escapedName).attr("error_then_volume",p),$("#CIRCUIT_"+e.escapedName+" a.errorPercentage").css("color",B.circuitErrorPercentageColorRange(e.errorPercentage)),v("circuit","#CIRCUIT_"+e.escapedName+" circle",d,e.errorPercentage),e.graphValues?_("circuit","#CIRCUIT_"+e.escapedName+" path",e.graphValues):_("circuit","#CIRCUIT_"+e.escapedName+" path",l),a&&B.sortSameAsLast()}function g(t){var e=(Math.round(t*Math.pow(10,1))/Math.pow(10,1)).toString();return-1==e.indexOf(".")&&(e+=".0"),e}function v(t,e,r,o){var n=B[t+"CircleXaxis"](r);parseInt(n)>parseInt(I)&&(n=I);var i=B[t+"CircleYaxis"](r);parseInt(i)>parseInt(C)&&(i=C);var a=B[t+"CircleRadius"](r);parseInt(a)>parseInt(M)&&(a=M),d3.selectAll(e).transition().duration(400).attr("cy",i).attr("cx",n).attr("r",a).style("fill",B[t+"ColorRange"](o))}function _(t,e,r){var o=(new Date).getTime(),n=B[t+e+"_data"];for(void 0===n?(n="object"==typeof r?r:[{v:parseFloat(r),t:o}],B[t+e+"_data"]=n):"object"==typeof r?n=r:n.push({v:parseFloat(r),t:o});n.length>200;)n.shift();if(1!=n.length||0!=n[0].v){n.length>1&&0==n[0].v&&0!=n[1].v&&n.shift();var i=d3.time.scale().domain([new Date(o-12e4),new Date(o)]).range([0,140]),s=d3.min(n,function(t){return t.v}),c=d3.max(n,function(t){return t.v}),l=d3.scale.linear().domain([s,c]).nice().range([60,0]);a=d3.svg.line().x(function(t,e){return i(new Date(t.t))}).y(function(t){return l(t.v)}).interpolate("basis"),d3.selectAll(e).attr("d",a(n))}}function f(t){$("#CIRCUIT_"+t).remove()}var B=this;B.args=e,void 0==B.args&&(B.args={}),this.containerId=t;var I="40%",C="40%",M="125";B.circuitCircleRadius=d3.scale.pow().exponent(.5).domain([0,400]).range(["5",M]),B.circuitCircleYaxis=d3.scale.linear().domain([0,400]).range(["30%",I]),B.circuitCircleXaxis=d3.scale.linear().domain([0,400]).range(["30%",C]),B.circuitColorRange=d3.scale.linear().domain([10,25,40,50]).range(["green","#FFCC00","#FF9900","red"]),B.circuitErrorPercentageColorRange=d3.scale.linear().domain([0,10,35,50]).range(["grey","black","#FF9900","red"]),setInterval(function(){B.sortSameAsLast()},1e4),B.eventSourceMessageListener=function(t){var e=JSON.parse(t.data);e&&(e.reportingHosts||(e.reportingHosts=1),e&&"HystrixCommand"==e.type&&("true"==e.deleteData?f(e.escapedName):m(e)))}},HystrixCommandMonitor.prototype.sortByVolume=function(){var t="desc";"rate_desc"==this.sortedBy&&(t="asc"),this.sortByVolumeInDirection(t)},HystrixCommandMonitor.prototype.sortByVolumeInDirection=function(t){this.sortedBy="rate_"+t,$("#"+this.containerId+" div.monitor").tsort({order:t,attr:"rate_value"})},HystrixCommandMonitor.prototype.sortAlphabetically=function(){var t="asc";"alph_asc"==this.sortedBy&&(t="desc"),this.sortAlphabeticalInDirection(t)},HystrixCommandMonitor.prototype.sortAlphabeticalInDirection=function(t){this.sortedBy="alph_"+t,$("#"+this.containerId+" div.monitor").tsort("p.name",{order:t})},HystrixCommandMonitor.prototype.sortByError=function(){var t="desc";"error_desc"==this.sortedBy&&(t="asc"),this.sortByErrorInDirection(t)},HystrixCommandMonitor.prototype.sortByErrorInDirection=function(t){this.sortedBy="error_"+t,$("#"+this.containerId+" div.monitor").tsort(".errorPercentage .value",{order:t})},HystrixCommandMonitor.prototype.sortByErrorThenVolume=function(){var t="desc";"error_then_volume_desc"==this.sortedBy&&(t="asc"),this.sortByErrorThenVolumeInDirection(t)},HystrixCommandMonitor.prototype.sortByErrorThenVolumeInDirection=function(t){this.sortedBy="error_then_volume_"+t,$("#"+this.containerId+" div.monitor").tsort({order:t,attr:"error_then_volume"})},HystrixCommandMonitor.prototype.sortByLatency90=function(){var t="desc";"lat90_desc"==this.sortedBy&&(t="asc"),this.sortedBy="lat90_"+t,this.sortByMetricInDirection(t,".latency90 .value")},HystrixCommandMonitor.prototype.sortByLatency99=function(){var t="desc";"lat99_desc"==this.sortedBy&&(t="asc"),this.sortedBy="lat99_"+t,this.sortByMetricInDirection(t,".latency99 .value")},HystrixCommandMonitor.prototype.sortByLatency995=function(){var t="desc";"lat995_desc"==this.sortedBy&&(t="asc"),this.sortedBy="lat995_"+t,this.sortByMetricInDirection(t,".latency995 .value")},HystrixCommandMonitor.prototype.sortByLatencyMean=function(){var t="desc";"latMean_desc"==this.sortedBy&&(t="asc"),this.sortedBy="latMean_"+t,this.sortByMetricInDirection(t,".latencyMean .value")},HystrixCommandMonitor.prototype.sortByLatencyMedian=function(){var t="desc";"latMedian_desc"==this.sortedBy&&(t="asc"),this.sortedBy="latMedian_"+t,this.sortByMetricInDirection(t,".latencyMedian .value")},HystrixCommandMonitor.prototype.sortByMetricInDirection=function(t,e){$("#"+this.containerId+" div.monitor").tsort(e,{order:t})},HystrixCommandMonitor.prototype.sortSameAsLast=function(){"alph_asc"==this.sortedBy?this.sortAlphabeticalInDirection("asc"):"alph_desc"==this.sortedBy?this.sortAlphabeticalInDirection("desc"):"rate_asc"==this.sortedBy?this.sortByVolumeInDirection("asc"):"rate_desc"==this.sortedBy?this.sortByVolumeInDirection("desc"):"error_asc"==this.sortedBy?this.sortByErrorInDirection("asc"):"error_desc"==this.sortedBy?this.sortByErrorInDirection("desc"):"error_then_volume_asc"==this.sortedBy?this.sortByErrorThenVolumeInDirection("asc"):"error_then_volume_desc"==this.sortedBy?this.sortByErrorThenVolumeInDirection("desc"):"lat90_asc"==this.sortedBy?this.sortByMetricInDirection("asc",".latency90 .value"):"lat90_desc"==this.sortedBy?this.sortByMetricInDirection("desc",".latency90 .value"):"lat99_asc"==this.sortedBy?this.sortByMetricInDirection("asc",".latency99 .value"):"lat99_desc"==this.sortedBy?this.sortByMetricInDirection("desc",".latency99 .value"):"lat995_asc"==this.sortedBy?this.sortByMetricInDirection("asc",".latency995 .value"):"lat995_desc"==this.sortedBy?this.sortByMetricInDirection("desc",".latency995 .value"):"latMean_asc"==this.sortedBy?this.sortByMetricInDirection("asc",".latencyMean .value"):"latMean_desc"==this.sortedBy?this.sortByMetricInDirection("desc",".latencyMean .value"):"latMedian_asc"==this.sortedBy?this.sortByMetricInDirection("asc",".latencyMedian .value"):"latMedian_desc"==this.sortedBy&&this.sortByMetricInDirection("desc",".latencyMedian .value")},HystrixCommandMonitor.prototype.sortedBy="alph_asc"}(window),function(t){function e(t){return location.pathname.slice(0,location.pathname.lastIndexOf("/")+1)+t}function r(t){console.log(t)}function o(t){if((t+="").length<=3)return t;x=t.split("."),x1=x[0],x2=x.length>1?"."+x[1]:"";for(var e=/(\d+)(\d{3})/;e.test(x1);)x1=x1.replace(e,"$1,$2");return x1+x2}var n,i;jQuery.get(e("../templates/hystrixThreadPool/hystrixThreadPool.html"),function(t){n=t}),jQuery.get(e("../templates/hystrixThreadPool/hystrixThreadPoolContainer.html"),function(t){i=t}),t.HystrixThreadPoolMonitor=function(t){function e(t){l(t),t.escapedName=t.name.replace(/([ !"#$%&'()*+,./:;<=>?@[\]^`{|}~])/g,"\\$1"),a(t),c(t)}function a(t){s(t,"propertyValue_queueSizeRejectionThreshold",!1),s(t,"propertyValue_metricsRollingStatisticalWindowInMilliseconds",!1)}function s(t,e,r){t[e]=r?p(t[e]/t.reportingHosts):Math.floor(t[e]/t.reportingHosts)}function c(t){var e=t.propertyValue_metricsRollingStatisticalWindowInMilliseconds/1e3,r=t.rollingCountThreadsExecuted;r<0&&(r=0),t.ratePerSecond=p(r/e),t.ratePerSecondPerHost=p(r/e/t.reportingHosts)}function l(t){d(t,"type"),d(t,"name"),d(t,"currentActiveCount"),d(t,"currentCompletedTaskCount"),d(t,"currentCorePoolSize"),d(t,"currentLargestPoolSize"),d(t,"currentMaximumPoolSize"),d(t,"currentPoolSize"),d(t,"currentQueueSize"),d(t,"currentTaskCount"),d(t,"rollingCountThreadsExecuted"),d(t,"rollingMaxActiveThreads"),d(t,"reportingHosts"),d(t,"propertyValue_queueSizeRejectionThreshold"),d(t,"propertyValue_metricsRollingStatisticalWindowInMilliseconds")}function d(t,e){if(void 0==t[e]){if("dependencyOwner"!=e)throw new Error("Key Missing: "+e+" for "+t.name);t.dependencyOwner=t.name}}function u(a){try{e(a)}catch(t){return void r("Failed preProcessData: "+t.message)}a.addCommas=o,a.roundNumber=p;var s=!1;if(!$("#THREAD_POOL_"+a.escapedName).length){var c=tmpl(i,a);$("#"+t+" span.loading").remove(),$("#"+t+" div.last").removeClass("last"),$("#"+t).append(c),$("#"+t+" div.monitor").last().addClass("last"),d3.selectAll("#graph_THREAD_POOL_"+a.escapedName+" svg").append("svg:path"),s=!0}$("#THREAD_POOL_"+a.escapedName).attr("rate_value",a.ratePerSecondPerHost),$("#THREAD_POOL_"+a.escapedName+" div.monitor_data").html(tmpl(n,a));var l=a.ratePerSecondPerHost,d=a.currentQueueSize/a.reportingHosts;h("#THREAD_POOL_"+a.escapedName+" circle",l,d),s&&m.sortSameAsLast()}function p(t){var e=(Math.round(t*Math.pow(10,1))/Math.pow(10,1)).toString();if(-1==e.indexOf(".")){e+=".";for(var r=0;r<1;r++)e+="0"}return e}function h(t,e,r){var o=m.circleXaxis(e);parseInt(o)>parseInt(g)&&(o=g);var n=m.circleYaxis(e);parseInt(n)>parseInt(v)&&(n=v);var i=m.circleRadius(e);parseInt(i)>parseInt(_)&&(i=_),d3.selectAll(t).transition().duration(400).attr("cy",n).attr("cx",o).attr("r",i).style("fill",m.colorRange(r))}function y(t){$("#THREAD_POOL_"+t).remove()}var m=this;this.containerId=t;var g="40%",v="40%",_="125";m.circleRadius=d3.scale.pow().exponent(.5).domain([0,2e3]).range(["5",_]),m.circleYaxis=d3.scale.linear().domain([0,2e3]).range(["30%",g]),m.circleXaxis=d3.scale.linear().domain([0,2e3]).range(["30%",v]),m.colorRange=d3.scale.linear().domain([10,25,40,50]).range(["green","#FFCC00","#FF9900","red"]),m.errorPercentageColorRange=d3.scale.linear().domain([0,10,35,50]).range(["grey","black","#FF9900","red"]),setInterval(function(){m.sortSameAsLast()},1e3),m.eventSourceMessageListener=function(t){var e=JSON.parse(t.data);e&&(e.reportingHosts||(e.reportingHosts=1),e&&"HystrixThreadPool"==e.type&&("true"==e.deleteData?y(e.escapedName):u(e)))}},HystrixThreadPoolMonitor.prototype.sortByVolume=function(){var t="desc";"rate_desc"==this.sortedBy&&(t="asc"),this.sortByVolumeInDirection(t)},HystrixThreadPoolMonitor.prototype.sortByVolumeInDirection=function(t){this.sortedBy="rate_"+t,$("#"+this.containerId+" div.monitor").tsort({order:t,attr:"rate_value"})},HystrixThreadPoolMonitor.prototype.sortAlphabetically=function(){var t="asc";"alph_asc"==this.sortedBy&&(t="desc"),this.sortAlphabeticalInDirection(t)},HystrixThreadPoolMonitor.prototype.sortAlphabeticalInDirection=function(t){this.sortedBy="alph_"+t,$("#"+this.containerId+" div.monitor").tsort("p.name",{order:t})},HystrixThreadPoolMonitor.prototype.sortByMetricInDirection=function(t,e){$("#"+this.containerId+" div.monitor").tsort(e,{order:t})},HystrixThreadPoolMonitor.prototype.sortSameAsLast=function(){"alph_asc"==this.sortedBy?this.sortAlphabeticalInDirection("asc"):"alph_desc"==this.sortedBy?this.sortAlphabeticalInDirection("desc"):"rate_asc"==this.sortedBy?this.sortByVolumeInDirection("asc"):"rate_desc"==this.sortedBy?this.sortByVolumeInDirection("desc"):"error_asc"==this.sortedBy?this.sortByErrorInDirection("asc"):"error_desc"==this.sortedBy?this.sortByErrorInDirection("desc"):"lat90_asc"==this.sortedBy?this.sortByMetricInDirection("asc","p90"):"lat90_desc"==this.sortedBy?this.sortByMetricInDirection("desc","p90"):"lat99_asc"==this.sortedBy?this.sortByMetricInDirection("asc","p99"):"lat99_desc"==this.sortedBy?this.sortByMetricInDirection("desc","p99"):"lat995_asc"==this.sortedBy?this.sortByMetricInDirection("asc","p995"):"lat995_desc"==this.sortedBy?this.sortByMetricInDirection("desc","p995"):"latMean_asc"==this.sortedBy?this.sortByMetricInDirection("asc","pMean"):"latMean_desc"==this.sortedBy?this.sortByMetricInDirection("desc","pMean"):"latMedian_asc"==this.sortedBy?this.sortByMetricInDirection("asc","pMedian"):"latMedian_desc"==this.sortedBy&&this.sortByMetricInDirection("desc","pMedian")},HystrixThreadPoolMonitor.prototype.sortedBy="alph_asc"}(window);